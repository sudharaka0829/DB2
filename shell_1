
# Switch to the db2inst1 user and define functions
su - db2inst1 << 'EOF'  | grep -v 'Last'
# DB2 connection details
DB_USER="your_db_username"
DB_PASS="your_db_password"
DB_NAME="pegadb"

# Function to execute DB2 queries
execute_db2_query() {
    db2 connect to $DB_NAME > /dev/null 2>&1
    db2 -x "$1"
}

# Function to get the database size
get_database_size() {
    execute_db2_query "select sum(TBSP_USED_SIZE_KB) / 1024 / 1024 as DATABASE_SIZE from sysibmadm.TBSP_UTILIZATION" | grep -o '[0-9]*' | head -n1
}



# Call functions to collect data
database_size=$(get_database_size | sed 's/^[[:space:]]*//')

# Output data in a format readable by Zabbix
echo "DatabaseSize:$database_size"

EOF
